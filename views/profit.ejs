<%- include('partials/header') %>
<div class="container mx-auto p-4">
  <h2 class="text-3xl font-bold mb-6 text-center text-white">المشتريات والمبيعات وصافي الربح</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
    <div class="glass p-6 rounded-lg shadow-lg text-center">
      <h3 class="text-lg font-bold mb-2 text-gray-300">إجمالي المشتريات</h3>
      <p class="text-3xl font-bold text-green-400"><%= totalPurchases.toFixed(2) %> ج.م</p>
    </div>
    <div class="glass p-6 rounded-lg shadow-lg text-center">
      <h3 class="text-lg font-bold mb-2 text-gray-300">إجمالي المبيعات</h3>
      <p class="text-3xl font-bold text-blue-400"><%= totalSales.toFixed(2) %> ج.م</p>
    </div>
    <div class="glass p-6 rounded-lg shadow-lg text-center">
      <h3 class="text-lg font-bold mb-2 text-gray-300">إجمالي المصروفات</h3>
      <p class="text-3xl font-bold text-orange-400"><%= totalExpenses.toFixed(2) %> ج.م</p>
    </div>
    <div class="glass p-6 rounded-lg shadow-lg text-center">
      <h3 class="text-lg font-bold mb-2 text-gray-300">صافي الربح</h3>
      <p class="text-3xl font-bold text-red-400"><%= netProfit.toFixed(2) %> ج.م</p>
    </div>
  </div>

  <div class="glass p-6 rounded-lg shadow-lg mb-8">
    <h3 class="text-2xl font-bold mb-4 text-white">المشتريات</h3>
    <div class="overflow-x-auto">
      <table class="w-full table-auto border-collapse">
        <thead>
          <tr class="bg-gray-800">
            <th class="p-3 text-right">التاريخ</th>
            <th class="p-3 text-right">رقم الموديل</th>
            <th class="p-3 text-right">اسم المورد</th>
            <th class="p-3 text-right">اسم القطعة</th>
            <th class="p-3 text-right">الكمية</th>
            <th class="p-3 text-right">سعر الوحدة</th>
            <th class="p-3 text-right">الإجمالي</th>
          </tr>
        </thead>
        <tbody>
          <% purchases.forEach(p => { %>
          <tr class="border-b border-gray-800 hover:bg-gray-700">
            <td class="p-3"><%= p.createdAt.toISOString().slice(0,10) %></td>
            <td class="p-3"><%= p.modelNumber %></td>
            <td class="p-3"><%= p.customer %></td>
            <td class="p-3"><%= p.name %></td>
            <td class="p-3"><%= p.quantity %></td>
            <td class="p-3"><%= p.price %></td>
            <td class="p-3 text-green-400 font-semibold"><%= (p.price * p.quantity).toFixed(2) %> ج.م</td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>

  <div class="glass p-6 rounded-lg shadow-lg">
    <h3 class="text-2xl font-bold mb-4 text-white">المصروفات</h3>
    <div class="overflow-x-auto">
      <table class="w-full table-auto border-collapse">
        <thead>
          <tr class="bg-gray-800">
            <th class="p-3 text-right">التاريخ</th>
            <th class="p-3 text-right">الوصف</th>
            <th class="p-3 text-right">المبلغ</th>
          </tr>
        </thead>
        <tbody>
          <% expenses.forEach(expense => { %>
          <tr class="border-b border-gray-800 hover:bg-gray-700">
            <td class="p-3"><%= expense.date.toISOString().slice(0,10) %></td>
            <td class="p-3"><%= expense.description %></td>
            <td class="p-3 text-red-400 font-semibold"><%= expense.amount.toFixed(2) %> ج.م</td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>
<%- include('partials/footer') %>